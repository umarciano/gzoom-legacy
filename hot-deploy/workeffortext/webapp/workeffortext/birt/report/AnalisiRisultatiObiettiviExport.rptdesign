<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.21" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.6.2.r262_v20110209 Build &lt;2.6.2.v20110214-1523></property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[importPackage(Packages.org.ofbiz.base.util);
importPackage(Packages.org.ofbiz.entity.condition);
importPackage(Packages.org.ofbiz.entity.util); 
importPackage(Packages.javolution.util);
    
module = "AnalisiRisultatiObiettiviExport.rptdesign";

locale = reportContext.getLocale();
timeZone = reportContext.getTimeZone();
    
// Label
uiLabelMap = FastMap.newInstance();
resources = "CommonUiLabels|WorkeffortExtUiLabels|CommondataExtUiLabels|WorkeffortExtEntityUiLabels|BaseContentUiLabels";
if(resources != null) {
	resourceArray = StringUtil.split(resources, '|');
    for(i = 0; i < resourceArray.size(); i++) {
    	resource = resourceArray[i];
    	uiLabelMap.putAll(UtilProperties.getResourceBundleMap(resource, locale));
    }
}

//getTitle
function getTitle (str){
	title = "";
    if(str != null) {
    	lbl = uiLabelMap.get(str); 
    	if( lbl != null) {
    		title = lbl; 
        } else {
			title = str;        	
        }
    }
    return title;
}

//
// Elimina le virgole per esportazione csv
function cleanComma (str){
	res = "";
    if(str != null) {
    	res = str.replace("," , " ");
    }
    return res;
}]]></method>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">98</property>
    <data-sources>
        <script-data-source name="ScriptedDS" id="7"/>
    </data-sources>
    <data-sets>
        <script-data-set name="WorkEffortAchieveDS" id="8">
            <property name="isVisible">true</property>
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">workEffortId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">comments</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">parentTypeId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">description</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">workEffortName</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">inChargeName</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">orgUnitName</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">estimatedStartDate</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">estimatedCompletionDate</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">maxTransactionDate</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">birtImageSrc</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">imageValue</property>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">alertContentId</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">alertSrc</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">budgetValue</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">workEffortId</property>
                </structure>
                <structure>
                    <property name="columnName">comments</property>
                </structure>
                <structure>
                    <property name="columnName">parentTypeId</property>
                </structure>
                <structure>
                    <property name="columnName">description</property>
                </structure>
                <structure>
                    <property name="columnName">workEffortName</property>
                </structure>
                <structure>
                    <property name="columnName">inChargeName</property>
                </structure>
                <structure>
                    <property name="columnName">orgUnitName</property>
                </structure>
                <structure>
                    <property name="columnName">estimatedStartDate</property>
                </structure>
                <structure>
                    <property name="columnName">estimatedCompletionDate</property>
                </structure>
                <structure>
                    <property name="columnName">maxTransactionDate</property>
                </structure>
                <structure>
                    <property name="columnName">birtImageSrc</property>
                </structure>
                <structure>
                    <property name="columnName">imageValue</property>
                </structure>
                <structure>
                    <property name="columnName">alertContentId</property>
                    <text-property name="displayName">alertContentId</text-property>
                </structure>
                <structure>
                    <property name="columnName">alertSrc</property>
                    <text-property name="displayName">alertSrc</text-property>
                </structure>
                <structure>
                    <property name="columnName">budgetValue</property>
                    <text-property name="displayName">budgetValue</text-property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">workEffortId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">comments</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">parentTypeId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">description</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">workEffortName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">inChargeName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">orgUnitName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">estimatedStartDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">estimatedCompletionDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">maxTransactionDate</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">birtImageSrc</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">imageValue</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">alertContentId</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">alertSrc</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">budgetValue</property>
                        <property name="dataType">decimal</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">ScriptedDS</property>
            <method name="open"><![CDATA[workEffortAchieveViewList = null;
try {

	req = reportContext.getParameterValue("request");
	session = req.getSession();
	
	workEffortAchieveViewList = session.getAttribute("workEffortAchieveList");
    
} catch (e) {
    Debug.logError(e, module);
}

maxRows = 0;
rowIdx = 0;
if (workEffortAchieveViewList) {
    maxRows = workEffortAchieveViewList.size();
}

]]></method>
            <method name="fetch"><![CDATA[if (rowIdx >= maxRows ) return false;
workEffortAchieveView = workEffortAchieveViewList.get(rowIdx);

row["workEffortId"] = workEffortAchieveView.get("workEffortId");
row["comments"] = cleanComma(workEffortAchieveView.get("comments"));
row["parentTypeId"] = workEffortAchieveView.get("parentTypeId");
row["description"] = cleanComma(workEffortAchieveView.get("description"));
row["workEffortName"] = cleanComma(workEffortAchieveView.get("workEffortName"));
row["inChargeName"] = cleanComma(workEffortAchieveView.get("inChargeName"));
row["orgUnitName"] = cleanComma(workEffortAchieveView.get("orgUnitName"));
row["estimatedStartDate"] = workEffortAchieveView.get("estimatedStartDate");
row["estimatedCompletionDate"] = workEffortAchieveView.get("estimatedCompletionDate");
row["maxTransactionDate"] = workEffortAchieveView.get("maxTransactionDate");
row["birtImageSrc"] = workEffortAchieveView.get("birtImageSrc");
row["imageValue"] = workEffortAchieveView.get("imageValue");
row["budgetValue"] = workEffortAchieveView.get("budgetValue");
row["alertContentId"] = workEffortAchieveView.get("alertContentId");
row["alertSrc"] = workEffortAchieveView.get("alertSrc");

rowIdx ++;

return true;]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="NewSimpleMasterPage" id="160"/>
    </page-setup>
    <body>
        <table id="73">
            <property name="width">9.377551020408163in</property>
            <property name="dataSet">WorkEffortAchieveDS</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">workEffortId</property>
                    <expression name="expression" type="javascript">dataSetRow["workEffortId"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">comments</property>
                    <expression name="expression" type="javascript">dataSetRow["comments"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">parentTypeId</property>
                    <expression name="expression" type="javascript">dataSetRow["parentTypeId"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">description</property>
                    <expression name="expression" type="javascript">dataSetRow["description"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">workEffortName</property>
                    <expression name="expression" type="javascript">dataSetRow["workEffortName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">inChargeName</property>
                    <expression name="expression" type="javascript">dataSetRow["inChargeName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">orgUnitName</property>
                    <expression name="expression" type="javascript">dataSetRow["orgUnitName"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">estimatedStartDate</property>
                    <expression name="expression" type="javascript">dataSetRow["estimatedStartDate"]</expression>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="name">estimatedCompletionDate</property>
                    <expression name="expression" type="javascript">dataSetRow["estimatedCompletionDate"]</expression>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="name">maxTransactionDate</property>
                    <expression name="expression" type="javascript">dataSetRow["maxTransactionDate"]</expression>
                    <property name="dataType">date</property>
                </structure>
                <structure>
                    <property name="name">birtImageSrc</property>
                    <expression name="expression" type="javascript">dataSetRow["birtImageSrc"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">imageValue</property>
                    <expression name="expression" type="javascript">dataSetRow["imageValue"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">budgetValue</property>
                    <expression name="expression" type="javascript">dataSetRow["budgetValue"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <column id="102">
                <property name="width">0.7142857142857143in</property>
            </column>
            <column id="148">
                <property name="width">0.7857142857142857in</property>
            </column>
            <column id="103">
                <property name="width">1.2755102040816326in</property>
            </column>
            <column id="153">
                <property name="width">1.0510204081632653in</property>
            </column>
            <column id="104">
                <property name="width">1.2857142857142858in</property>
            </column>
            <column id="158">
                <property name="width">0.7244897959183674in</property>
            </column>
            <column id="105">
                <property name="width">0.9795918367346939in</property>
            </column>
            <column id="106">
                <property name="width">0.9387755102040817in</property>
            </column>
            <column id="165">
                <property name="width">0.7142857142857143in</property>
            </column>
            <header>
                <row id="74">
                    <cell id="75">
                        <data id="112">
                            <property name="resultSetColumn">comments</property>
                        </data>
                    </cell>
                    <cell id="144">
                        <text-data id="126">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewNotice");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="76">
                        <text-data id="113">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewResponsible");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="149">
                        <text-data id="173">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewOrgUnit");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="77">
                        <text-data id="109">
                            <expression name="valueExpr">getTitle("parentFormValidity");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="154"/>
                    <cell id="78">
                        <text-data id="110">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewValidPeriod");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="79">
                        <text-data id="161">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewScore");</expression>
                            <property name="contentType">text</property>
                        </text-data>
                    </cell>
                    <cell id="162">
                        <text-data id="170">
                            <expression name="valueExpr">getTitle("WorkEffortAchieveViewBudget")</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="81">
                    <property name="backgroundAttachment">scroll</property>
                    <cell id="82">
                        <data id="114">
                            <property name="resultSetColumn">workEffortName</property>
                        </data>
                    </cell>
                    <cell id="145">
                        <data id="116">
                            <property name="resultSetColumn">description</property>
                        </data>
                    </cell>
                    <cell id="83">
                        <data id="117">
                            <property name="resultSetColumn">inChargeName</property>
                        </data>
                    </cell>
                    <cell id="150">
                        <data id="115">
                            <property name="resultSetColumn">orgUnitName</property>
                        </data>
                    </cell>
                    <cell id="84">
                        <data id="118">
                            <property name="resultSetColumn">estimatedStartDate</property>
                        </data>
                    </cell>
                    <cell id="155">
                        <data id="119">
                            <property name="resultSetColumn">estimatedCompletionDate</property>
                        </data>
                    </cell>
                    <cell id="85">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                        <data id="120">
                            <property name="resultSetColumn">maxTransactionDate</property>
                        </data>
                    </cell>
                    <cell id="86">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">1</property>
                        <data id="127">
                            <list-property name="visibility">
                                <structure>
                                    <property name="format">all</property>
                                    <expression name="valueExpr" type="javascript">row["imageValue"]==-1</expression>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">imageValue</property>
                        </data>
                    </cell>
                    <cell id="163">
                        <data id="172">
                            <property name="resultSetColumn">budgetValue</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="95">
                    <cell id="96"/>
                    <cell id="147"/>
                    <cell id="97"/>
                    <cell id="152"/>
                    <cell id="98"/>
                    <cell id="157"/>
                    <cell id="99"/>
                    <cell id="100"/>
                    <cell id="164"/>
                </row>
            </footer>
        </table>
    </body>
</report>
